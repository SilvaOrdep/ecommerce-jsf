<ui:composition
  template="template.xhtml"
  xmlns="http://www.w3.org/1999/xhtml"
  xmlns:h="http://java.sun.com/jsf/html"
  xmlns:f="http://java.sun.com/jsf/core"
  xmlns:p="http://primefaces.org/ui"
  xmlns:ui="http://java.sun.com/jsf/facelets"
>
  <ui:define name="content">
    <!-- Script para conectar busca do template com grid local -->
    <h:outputScript>
      PrimeFaces.widget.InputText.prototype.oldInit =
      PrimeFaces.widget.InputText.prototype.init;
      PrimeFaces.widget.InputText.prototype.init = function(cfg) {
      this.oldInit(cfg); if (this.jq.attr('id') === 'menuForm:searchInput') {
      var self = this; this.jq.off('keyup').on('keyup', function(e) { var
      timeout = self.jq.data('timeout'); if (timeout) clearTimeout(timeout);
      timeout = setTimeout(function() { var searchValue = self.jq.val();
      PrimeFaces.ajax.Request.handle({ source: 'menuForm:searchInput', process:
      'menuForm:searchInput', update: 'formProdutos:produtosGrid', params:
      [{name: 'javax.faces.behavior.event', value: 'change'}] }); }, 300);
      self.jq.data('timeout', timeout); }); } };
    </h:outputScript>

    <div class="ecommerce-container">
      <!-- Banner Principal -->
      <div class="hero-banner">
        <h1 class="hero-title">
          <i class="pi pi-shopping-cart"></i>
          Bem-vindo √† Nossa Loja
        </h1>
        <p class="hero-subtitle">
          Encontre os melhores produtos com os melhores pre√ßos
        </p>
      </div>

      <!-- Grid de Produtos -->
      <h:form id="formProdutos">
        <p:growl id="messages" showDetail="true" life="3000" />

        <div class="products-section">
          <div class="section-header">
            <h2 class="section-title">
              <i class="pi pi-box"></i>
              Todos os Produtos
            </h2>
            <p:commandButton
              value="Recarregar"
              icon="pi pi-refresh"
              styleClass="p-button-rounded p-button-outlined"
              action="#{produtoController.carregarProdutos}"
              update="produtosGrid messages"
            />
          </div>

          <p:dataGrid
            id="produtosGrid"
            var="produto"
            value="#{produtoController.produtos}"
            columns="4"
            layout="grid"
            rows="12"
            paginator="true"
            paginatorPosition="bottom"
            paginatorTemplate="{CurrentPageReport} {FirstPageLink} {PreviousPageLink} {PageLinks} {NextPageLink} {LastPageLink} {RowsPerPageDropdown}"
            rowsPerPageTemplate="8,12,16,20"
            emptyMessage="Nenhum produto encontrado"
          >
            <div class="product-card">
              <!-- Imagem do Produto -->
              <div class="product-image-wrapper">
                <div class="product-image">
                  <i class="pi pi-image"></i>
                </div>
              </div>

              <!-- Informa√ß√µes do Produto -->
              <div class="product-info">
                <h3 class="product-title" title="#{produto.xprod}">
                  #{produto.xprod}
                </h3>

                <div class="product-code">C√≥digo: #{produto.cprod}</div>

                <div class="product-details">
                  <span class="detail-item">
                    <i class="pi pi-box"></i>
                    Un: #{produto.ucom}
                  </span>
                </div>

                <!-- Pre√ßo e A√ß√£o -->
                <div class="product-footer">
                  <div class="product-price-section">
                    <div class="product-price">
                      <h:outputText value="#{produto.vuncom}">
                        <f:convertNumber
                          type="currency"
                          currencySymbol="R$ "
                          groupingUsed="true"
                          minFractionDigits="2"
                        />
                      </h:outputText>
                    </div>
                    <div class="product-installment">
                      em at√© 12x de
                      <h:outputText value="#{produto.vuncom / 12}">
                        <f:convertNumber
                          type="currency"
                          currencySymbol="R$ "
                          groupingUsed="true"
                          minFractionDigits="2"
                        />
                      </h:outputText>
                    </div>
                  </div>

                  <div class="product-actions">
                    <button
                      type="button"
                      class="ui-button ui-widget ui-state-default ui-corner-all ui-button-icon-only p-button-success p-button-rounded add-cart-btn"
                      title="Adicionar ao carrinho"
                      onclick="alert('Produto adicionado ao carrinho!')"
                    >
                      <span
                        class="ui-button-icon-left ui-icon pi pi-shopping-cart"
                      ></span>
                      <span class="ui-button-text ui-c">üõí</span>
                    </button>

                    <button
                      type="button"
                      class="ui-button ui-widget ui-state-default ui-corner-all ui-button-icon-only p-button-rounded p-button-outlined p-button-secondary favorite-btn"
                      title="Adicionar aos favoritos"
                      onclick="alert('Adicionado aos favoritos!')"
                    >
                      <span
                        class="ui-button-icon-left ui-icon pi pi-heart"
                      ></span>
                      <span class="ui-button-text ui-c">‚ô•</span>
                    </button>
                  </div>
                </div>

                <!-- Estoque dispon√≠vel -->
                <div class="product-stock">
                  <i class="pi pi-check-circle"></i>
                  Estoque dispon√≠vel
                </div>
              </div>
            </div>
          </p:dataGrid>
        </div>
      </h:form>

      <!-- Rodap√© informativo -->
      <div class="info-footer">
        <div class="info-grid">
          <div class="info-item">
            <i class="pi pi-truck"></i>
            <h4>Frete Gr√°tis</h4>
            <p>Em compras acima de R$ 200</p>
          </div>
          <div class="info-item">
            <i class="pi pi-shield"></i>
            <h4>Compra Segura</h4>
            <p>Seus dados protegidos</p>
          </div>
          <div class="info-item">
            <i class="pi pi-replay"></i>
            <h4>Devolu√ß√£o Gr√°tis</h4>
            <p>At√© 30 dias para trocar</p>
          </div>
          <div class="info-item">
            <i class="pi pi-credit-card"></i>
            <h4>Parcele sem Juros</h4>
            <p>Em at√© 12x no cart√£o</p>
          </div>
        </div>
      </div>
    </div>
  </ui:define>
</ui:composition>
