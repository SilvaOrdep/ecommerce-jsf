<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml"
      xmlns:h="http://java.sun.com/jsf/html"
      xmlns:f="http://java.sun.com/jsf/core"
      xmlns:p="http://primefaces.org/ui"
      xmlns:ui="http://java.sun.com/jsf/facelets">

    <f:view locale="pt_BR">
        <h:head>
            <title>NF-e Emissor</title>
            <meta charset="UTF-8" />
            <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
            
            <!-- CSS customizado - Condicional -->
            <h:outputStylesheet name="css/styles.css"/>
        </h:head>
        
        <h:body>
            <!-- Growl com form próprio -->
            <h:form>
                <p:growl id="growl" showDetail="true" life="3000" />
            </h:form>
            
            <ui:fragment rendered="#{loginController.loggedIn}">
                <div class="layout-container">
                    <!-- Header -->
                    <div class="layout-header">
                        <div class="header-content">
                            <!-- Form para o menu -->
                            <h:form id="menuForm">
                                <div class="header-title">
                                    <i class="pi pi-file" style="font-size: 1.5rem; margin-right: 10px;"></i>
                                    <span style="font-size: 1.5rem; font-weight: bold;">NF-e Emissor</span>
                                </div>
                                
                                <p:menubar styleClass="main-menu">
                                    <p:menuitem value="Início" icon="pi pi-home" outcome="/index.xhtml"/>
                                    
                                    <p:submenu label="Cadastros" icon="pi pi-fw pi-database" 
                                              rendered="#{loginController.admin}">
                                        <p:menuitem value="Produtos" icon="pi pi-fw pi-box" outcome="/produtos.xhtml"/>
                                        <p:menuitem value="Clientes" icon="pi pi-fw pi-users" outcome="/clientes.xhtml"/>
                                        <p:menuitem value="Usuários" icon="pi pi-fw pi-user" outcome="/usuarios.xhtml"/>
                                    </p:submenu>
                                    
                                    <p:submenu label="Configurações" icon="pi pi-fw pi-cog" 
                                              rendered="#{loginController.admin}">
                                        <p:menuitem value="Empresa" icon="pi pi-fw pi-building" outcome="/empresa.xhtml"/>
                                        <p:menuitem value="Sistema" icon="pi pi-fw pi-sliders-h" outcome="/configuracao.xhtml"/>
                                    </p:submenu>
                                    
                                    <p:menuitem value="Vendas" icon="pi pi-shopping-cart" outcome="/vendas.xhtml"/>
                                    
                                    <f:facet name="options">
                                        <div class="user-info">
                                            <p:outputLabel value="Bem-vindo, #{loginController.usuarioLogado.nome}" 
                                                          style="margin-right: 10px;"/>
                                            <!-- Botão de logout -->
                                            <p:commandButton value="Sair" icon="pi pi-power-off" 
                                                           action="#{loginController.logout}"
                                                           styleClass="logout-button"
                                                           immediate="true"
                                                           ajax="false"/>
                                        </div>
                                    </f:facet>
                                </p:menubar>
                            </h:form>
                        </div>
                    </div>
                    
                    <!-- Main Content -->
                    <div class="layout-content">
                        <ui:insert name="content">
                            <div class="welcome-content">
                                <h1>Bem-vindo ao Sistema NF-e Emissor</h1>
                                <p>Selecione uma opção no menu acima para começar.</p>
                            </div>
                        </ui:insert>
                    </div>
                </div>
            </ui:fragment>
            
            <ui:fragment rendered="#{not loginController.loggedIn}">
                <div style="text-align: center; padding: 50px;">
                    <h:form>
                        <h2>Acesso não autorizado</h2>
                        <p>Você precisa fazer login para acessar esta página.</p>
                        <p:button value="Ir para Login" outcome="/login.xhtml" />
                    </h:form>
                </div>
            </ui:fragment>
        </h:body>
    </f:view>
</html>